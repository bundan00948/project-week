<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,  initial-scale=1.0">
    <title>Staff Panel - Macau Traffic Monitor</title>
    <link rel="stylesheet" href="https: //cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https: //www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https: //www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        * {
            margin:  0;
            padding:  0;
            box-sizing:  border-box;
            font-family:  'Segoe UI',  Tahoma,  Geneva,  Verdana,  sans-serif;
        }
        
        body {
            background:  linear-gradient(rgba(0,  0,  0,  0.8),  rgba(0,  0,  0,  0.8)),  
                        url('https: //img1.wsimg.com/isteam/getty/2154404610') no-repeat center center fixed;
            background-size:  cover;
            color:  #fff;
            min-height:  100vh;
            padding:  20px;
            overflow-x:  hidden;
        }
        
        .container {
            max-width:  1400px;
            margin:  0 auto;
        }
        
        header {
            text-align:  center;
            padding:  20px 0;
            margin-bottom:  20px;
            background:  rgba(0,  0,  0,  0.6);
            border-radius:  15px;
            box-shadow:  0 8px 32px rgba(0,  0,  0,  0.3);
            backdrop-filter:  blur(10px);
            border:  1px solid rgba(255,  255,  255,  0.18);
            position:  relative;
        }
        
        .logo-container {
            display:  flex;
            align-items:  center;
            justify-content:  center;
            gap:  15px;
            margin-bottom:  10px;
        }
        
        .logo {
            width:  80px;
            height:  80px;
            background:  linear-gradient(45deg,  #ffd700,  #ff8c00);
            border-radius:  50%;
            display:  flex;
            align-items:  center;
            justify-content:  center;
            box-shadow:  0 0 20px rgba(255,  215,  0,  0.5);
        }
        
        .logo i {
            font-size:  40px;
            color:  #8b0000;
        }
        
        h1 {
            font-size:  2.8rem;
            text-shadow:  0 2px 4px rgba(0,  0,  0,  0.5);
            margin-bottom:  5px;
        }
        
        .subtitle {
            font-size:  1.2rem;
            opacity:  0.9;
            max-width:  600px;
            margin:  0 auto 20px;
        }
        
        .auth-section {
            background:  rgba(255,  255,  255,  0.1);
            border-radius:  15px;
            padding:  25px;
            margin:  20px 0;
            box-shadow:  0 8px 32px rgba(0,  0,  0,  0.3);
            backdrop-filter:  blur(10px);
            border:  1px solid rgba(255,  255,  255,  0.18);
            text-align:  center;
        }
        
        .auth-section h2 {
            color:  #ffd700;
            margin-bottom:  20px;
        }
        
        .form-group {
            margin-bottom:  20px;
            text-align:  left;
        }
        
        .form-group label {
            display:  block;
            margin-bottom:  8px;
            font-weight:  bold;
        }
        
        .form-group input,  
        .form-group select,  
        .form-group textarea {
            width:  100%;
            padding:  12px;
            border-radius:  8px;
            border:  1px solid rgba(255,  255,  255,  0.3);
            background:  rgba(0,  0,  0,  0.3);
            color:  white;
            font-size:  1rem;
        }
        
        .btn {
            padding:  12px 25px;
            border-radius:  30px;
            border:  none;
            background:  #ffd700;
            color:  #000;
            font-weight:  bold;
            cursor:  pointer;
            transition:  all 0.3s ease;
            display:  inline-flex;
            align-items:  center;
            gap:  8px;
        }
        
        .btn: hover {
            transform:  translateY(-3px);
            box-shadow:  0 5px 15px rgba(0,  0,  0,  0.3);
        }
        
        .btn i {
            font-size:  1.2rem;
        }
        
        .btn-secondary {
            background:  rgba(255,  255,  255,  0.1);
            color:  white;
        }
        
        .btn-danger {
            background:  #ff4d4d;
            color:  white;
        }
        
        .btn-success {
            background:  #4dff4d;
            color:  #000;
        }
        
        .btn-warning {
            background:  #ff9900;
            color:  #000;
        }
        
        .btn-info {
            background:  #17a2b8;
            color:  white;
        }
        
        .cameras-section {
            display:  none;
        }
        
        .section-title {
            color:  #ffd700;
            margin:  25px 0 15px;
            display:  flex;
            align-items:  center;
            gap:  10px;
        }
        
        .camera-grid {
            display:  grid;
            grid-template-columns:  repeat(auto-fill,  minmax(300px,  1fr));
            gap:  20px;
            margin-top:  20px;
        }
        
        .camera-card {
            background:  rgba(255,  255,  255,  0.1);
            border-radius:  15px;
            padding:  20px;
            box-shadow:  0 8px 32px rgba(0,  0,  0,  0.3);
            backdrop-filter:  blur(10px);
            border:  1px solid rgba(255,  255,  255,  0.18);
            transition:  transform 0.3s ease;
        }
        
        .camera-card: hover {
            transform:  translateY(-5px);
            box-shadow:  0 12px 40px rgba(0,  0,  0,  0.4);
        }
        
        .camera-title {
            font-size:  1.2rem;
            margin-bottom:  15px;
            color:  #ffd700;
            display:  flex;
            align-items:  center;
            gap:  10px;
        }
        
        .camera-iframe {
            width:  100%;
            height:  180px;
            border-radius:  8px;
            border:  none;
            margin:  10px 0;
            background:  rgba(0,  0,  0,  0.3);
        }
        
        .camera-details {
            margin:  15px 0;
        }
        
        .camera-details p {
            margin:  8px 0;
            display:  flex;
            gap:  10px;
        }
        
        .camera-details strong {
            min-width:  100px;
            display:  inline-block;
        }
        
        .camera-actions {
            display:  flex;
            gap:  10px;
            margin-top:  15px;
            flex-wrap:  wrap;
        }
        
        .camera-actions .btn {
            flex:  1;
            min-width:  120px;
            justify-content:  center;
        }
        
        .modal {
            display:  none;
            position:  fixed;
            top:  0;
            left:  0;
            width:  100%;
            height:  100%;
            background:  rgba(0,  0,  0,  0.8);
            z-index:  1000;
            align-items:  center;
            justify-content:  center;
        }
        
        .modal-content {
            background:  rgba(0,  0,  0,  0.9);
            border-radius:  15px;
            padding:  30px;
            width:  90%;
            max-width:  600px;
            box-shadow:  0 10px 30px rgba(0,  0,  0,  0.5);
            border:  1px solid rgba(255,  255,  255,  0.18);
            position:  relative;
            max-height:  90vh;
            overflow-y:  auto;
        }
        
        .close-modal {
            position:  absolute;
            top:  20px;
            right:  20px;
            font-size:  1.5rem;
            cursor:  pointer;
            color:  #ffd700;
        }
        
        .modal h2 {
            color:  #ffd700;
            margin-bottom:  20px;
            text-align:  center;
        }
        
        .form-row {
            display:  flex;
            gap:  15px;
            margin-bottom:  20px;
        }
        
        .form-row .form-group {
            flex:  1;
        }
        
        .status-indicator {
            display:  inline-block;
            width:  12px;
            height:  12px;
            border-radius:  50%;
            margin-right:  8px;
        }
        
        .status-connected {
            background-color:  #4dff4d;
            box-shadow:  0 0 8px #4dff4d;
        }
        
        .status-disconnected {
            background-color:  #ff4d4d;
        }
        
        .notification {
            position:  fixed;
            top:  20px;
            right:  20px;
            padding:  15px 25px;
            border-radius:  8px;
            background:  rgba(0,  0,  0,  0.8);
            border-left:  4px solid #4dff4d;
            box-shadow:  0 5px 15px rgba(0,  0,  0,  0.3);
            z-index:  2000;
            display:  none;
            animation:  slideIn 0.3s ease;
        }
        
        .notification.error {
            border-left-color:  #ff4d4d;
        }
        
        @keyframes slideIn {
            from { transform:  translateX(100%); opacity:  0; }
            to { transform:  translateX(0); opacity:  1; }
        }
        
        footer {
            text-align:  center;
            padding:  20px;
            margin-top:  30px;
            font-size:  0.9rem;
            opacity:  0.8;
            background:  rgba(0,  0,  0,  0.6);
            border-radius:  15px;
            box-shadow:  0 8px 32px rgba(0,  0,  0,  0.3);
            backdrop-filter:  blur(10px);
            border:  1px solid rgba(255,  255,  255,  0.18);
        }
        
        @media (max-width:  768px) {
            .form-row {
                flex-direction:  column;
            }
            
            .camera-grid {
                grid-template-columns:  1fr;
            }
            
            h1 {
                font-size:  2.2rem;
            }
        }
        
        /* Bulk Update Styles */
        .bulk-section {
            background:  rgba(255,  255,  255,  0.1);
            border-radius:  15px;
            padding:  20px;
            margin:  20px 0;
            box-shadow:  0 8px 32px rgba(0,  0,  0,  0.3);
            backdrop-filter:  blur(10px);
            border:  1px solid rgba(255,  255,  255,  0.18);
        }
        
        .bulk-section h3 {
            color:  #ffd700;
            margin-bottom:  15px;
            display:  flex;
            align-items:  center;
            gap:  10px;
        }
        
        .bulk-controls {
            display:  flex;
            gap:  15px;
            margin-bottom:  20px;
            flex-wrap:  wrap;
        }
        
        .bulk-controls .btn {
            flex:  1;
            min-width:  150px;
            justify-content:  center;
        }
        
        .bulk-form {
            display:  none;
            background:  rgba(0,  0,  0,  0.3);
            border-radius:  10px;
            padding:  20px;
            margin-top:  20px;
        }
        
        .bulk-form.active {
            display:  block;
        }
        
        .bulk-form .form-group {
            margin-bottom:  15px;
        }
        
        .bulk-form .form-group label {
            display:  block;
            margin-bottom:  5px;
        }
        
        .bulk-actions {
            display:  flex;
            gap:  10px;
            margin-top:  15px;
        }
        
        .bulk-actions .btn {
            flex:  1;
        }
        
        .camera-selection {
            display:  flex;
            flex-wrap:  wrap;
            gap:  10px;
            margin-top:  10px;
            max-height:  150px;
            overflow-y:  auto;
            padding:  10px;
            background:  rgba(0,  0,  0,  0.2);
            border-radius:  8px;
        }
        
        .camera-selection-item {
            background:  rgba(255,  215,  0,  0.2);
            border:  1px solid rgba(255,  215,  0,  0.5);
            border-radius:  5px;
            padding:  5px 10px;
            display:  flex;
            align-items:  center;
            gap:  5px;
            font-size:  0.9rem;
        }
        
        .camera-selection-item .remove-btn {
            background:  none;
            border:  none;
            color:  #ff4d4d;
            cursor:  pointer;
            font-size:  1rem;
        }
        
        .select-all-container {
            display:  flex;
            align-items:  center;
            gap:  10px;
            margin:  10px 0;
        }
        
        .select-all-container input {
            width:  auto;
        }
        
        .progress-container {
            margin-top:  15px;
            display:  none;
        }
        
        .progress-bar {
            height:  10px;
            background:  rgba(255,  255,  255,  0.1);
            border-radius:  5px;
            overflow:  hidden;
        }
        
        .progress-fill {
            height:  100%;
            background:  #4dff4d;
            width:  0%;
            transition:  width 0.3s ease;
        }
        
        .progress-text {
            text-align:  center;
            margin-top:  5px;
            font-size:  0.9rem;
        }
        
        .stats-container {
            display:  flex;
            gap:  20px;
            margin:  20px 0;
            flex-wrap:  wrap;
        }
        
        .stat-card {
            background:  rgba(255,  255,  255,  0.1);
            border-radius:  10px;
            padding:  15px;
            text-align:  center;
            flex:  1;
            min-width:  120px;
        }
        
        .stat-value {
            font-size:  1.8rem;
            font-weight:  bold;
            color:  #ffd700;
            margin:  10px 0;
        }
        
        .stat-label {
            font-size:  0.9rem;
            opacity:  0.8;
        }
        
        /* Upload Section */
        .upload-section {
            background:  rgba(255,  255,  255,  0.1);
            border-radius:  15px;
            padding:  20px;
            margin:  20px 0;
            box-shadow:  0 8px 32px rgba(0,  0,  0,  0.3);
            backdrop-filter:  blur(10px);
            border:  1px solid rgba(255,  255,  255,  0.18);
        }
        
        .upload-section h3 {
            color:  #ffd700;
            margin-bottom:  15px;
            display:  flex;
            align-items:  center;
            gap:  10px;
        }
        
        .upload-form {
            background:  rgba(0,  0,  0,  0.3);
            border-radius:  10px;
            padding:  20px;
            margin-top:  20px;
        }
        
        .file-upload {
            border:  2px dashed rgba(255,  215,  0,  0.5);
            border-radius:  10px;
            padding:  30px;
            text-align:  center;
            margin-bottom:  20px;
            cursor:  pointer;
            transition:  all 0.3s ease;
        }
        
        .file-upload: hover {
            background:  rgba(255,  215,  0,  0.1);
            border-color:  #ffd700;
        }
        
        .file-upload i {
            font-size:  3rem;
            color:  #ffd700;
            margin-bottom:  15px;
        }
        
        .file-upload p {
            margin:  10px 0;
        }
        
        .file-input {
            display:  none;
        }
        
        .file-info {
            background:  rgba(0,  0,  0,  0.3);
            border-radius:  8px;
            padding:  15px;
            margin-top:  15px;
            display:  none;
        }
        
        .file-info.active {
            display:  block;
        }
        
        .preview-table {
            width:  100%;
            border-collapse:  collapse;
            margin-top:  15px;
            font-size:  0.9rem;
        }
        
        .preview-table th,  
        .preview-table td {
            border:  1px solid rgba(255,  255,  255,  0.2);
            padding:  8px;
            text-align:  left;
        }
        
        .preview-table th {
            background:  rgba(255,  215,  0,  0.2);
        }
        
        .preview-table tr: nth-child(even) {
            background:  rgba(255,  255,  255,  0.05);
        }
        
        .upload-actions {
            display:  flex;
            gap:  10px;
            margin-top:  15px;
        }
        
        .upload-actions .btn {
            flex:  1;
        }
        
        .upload-progress {
            margin-top:  20px;
            display:  none;
        }
        
        .upload-progress.active {
            display:  block;
        }
        
        .upload-status {
            margin-top:  10px;
            text-align:  center;
            font-weight:  bold;
        }
        
        .upload-status.processing {
            color:  #ffd700;
        }
        
        .upload-status.completed {
            color:  #4dff4d;
        }
        
        .upload-status.error {
            color:  #ff4d4d;
        }
        
        .template-link {
            display:  inline-block;
            margin-top:  10px;
            color:  #ffd700;
            text-decoration:  none;
        }
        
        .template-link: hover {
            text-decoration:  underline;
        }
        
        .tabs {
            display:  flex;
            gap:  10px;
            margin-bottom:  20px;
            border-bottom:  1px solid rgba(255,  255,  255,  0.2);
            padding-bottom:  10px;
        }
        
        .tab {
            padding:  10px 20px;
            border-radius:  30px;
            cursor:  pointer;
            background:  rgba(255,  255,  255,  0.1);
            transition:  all 0.3s ease;
        }
        
        .tab.active {
            background:  #ffd700;
            color:  #000;
            font-weight:  bold;
        }
        
        .tab-content {
            display:  none;
        }
        
        .tab-content.active {
            display:  block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-car"></i>
                </div>
                <div>
                    <h1>Staff Panel</h1>
                    <p class="subtitle">Manage Live Camera Feeds for Macau Traffic Monitor</p>
                </div>
            </div>
        </header>
        
        <div class="auth-section" id="authSection">
            <h2><i class="fas fa-lock"></i> Staff Login</h2>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="Enter your staff email">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter your password">
            </div>
            <button class="btn" id="loginBtn">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <p style="margin-top:  15px; color:  #ffd700;">
                <i class="fas fa-info-circle"></i> Demo credentials:  admin@macautraffic.com / password123
            </p>
        </div>
        
        <div class="cameras-section" id="camerasSection">
            <div style="display:  flex; justify-content:  space-between; align-items:  center;">
                <h2 class="section-title"><i class="fas fa-video"></i> Live Camera Management</h2>
                <div>
                    <span class="status-indicator" id="statusIndicator"></span>
                    <span id="statusText">Connected to Firebase</span>
                </div>
            </div>
            
            <div style="display:  flex; gap:  15px; margin:  20px 0; flex-wrap:  wrap;">
                <button class="btn" id="addCameraBtn">
                    <i class="fas fa-plus"></i> Add New Camera
                </button>
                <button class="btn btn-secondary" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i> Refresh Data
                </button>
                <button class="btn btn-warning" id="bulkUpdateBtn">
                    <i class="fas fa-edit"></i> Bulk Update
                </button>
                <button class="btn btn-info" id="bulkUploadBtn">
                    <i class="fas fa-upload"></i> Bulk Upload
                </button>
                <button class="btn btn-danger" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-label">Total Cameras</div>
                    <div class="stat-value" id="totalCameras">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Selected</div>
                    <div class="stat-value" id="selectedCameras">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Updated</div>
                    <div class="stat-value" id="updatedCameras">0</div>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="bulk-update">Bulk Update</div>
                <div class="tab" data-tab="bulk-upload">Bulk Upload</div>
            </div>
            
            <!-- Bulk Update Section -->
            <div class="tab-content active" id="bulkUpdateTab">
                <div class="bulk-section">
                    <h3><i class="fas fa-edit"></i> Bulk Update Cameras</h3>
                    <p>Select cameras below and update their properties in bulk.</p>
                    
                    <div class="bulk-controls">
                        <button class="btn btn-secondary" id="selectAllBtn">
                            <i class="fas fa-check-square"></i> Select All
                        </button>
                        <button class="btn btn-secondary" id="deselectAllBtn">
                            <i class="fas fa-square"></i> Deselect All
                        </button>
                    </div>
                    
                    <div class="camera-selection" id="cameraSelection">
                        <p>No cameras selected</p>
                    </div>
                    
                    <button class="btn btn-warning" id="openBulkFormBtn">
                        <i class="fas fa-edit"></i> Update Selected Cameras
                    </button>
                    
                    <div class="bulk-form" id="bulkUpdateForm">
                        <h3>Update Properties</h3>
                        <div class="form-group">
                            <label for="bulkLocation">Location</label>
                            <select id="bulkLocation">
                                <option value="">-- Keep Current --</option>
                                <option value="macau-city">Macau City</option>
                                <option value="taipa">Taipa</option>
                                <option value="bridges">Cross-Sea Bridges</option>
                                <option value="border">Border Crossings</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="bulkEmbedUrl">Embed URL (applies to all selected)</label>
                            <input type="text" id="bulkEmbedUrl" placeholder="New embed URL (leave blank to keep current)">
                        </div>
                        
                        <div class="bulk-actions">
                            <button class="btn btn-warning" id="applyBulkUpdateBtn">
                                <i class="fas fa-sync-alt"></i> Apply Updates
                            </button>
                            <button class="btn btn-secondary" id="cancelBulkUpdateBtn">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                        
                        <div class="progress-container" id="progressContainer">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                            <div class="progress-text" id="progressText">0% Complete</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bulk Upload Section -->
            <div class="tab-content" id="bulkUploadTab">
                <div class="upload-section">
                    <h3><i class="fas fa-upload"></i> Bulk Upload Cameras</h3>
                    <p>Upload a CSV file to add multiple cameras at once.</p>
                    <a href="#" class="template-link" id="downloadTemplate">
                        <i class="fas fa-download"></i> Download CSV Template
                    </a>
                    
                    <div class="upload-form">
                        <div class="file-upload" id="fileUploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Drag & Drop your CSV file here</p>
                            <p>or</p>
                            <button class="btn btn-info" id="browseFileBtn">
                                <i class="fas fa-folder-open"></i> Browse Files
                            </button>
                            <input type="file" id="fileInput" class="file-input" accept=".csv">
                        </div>
                        
                        <div class="file-info" id="fileInfo">
                            <h4>File Information</h4>
                            <p><strong>File Name: </strong> <span id="fileName">-</span></p>
                            <p><strong>Size: </strong> <span id="fileSize">-</span></p>
                            
                            <div class="preview-table-container">
                                <h4>Preview</h4>
                                <table class="preview-table" id="previewTable">
                                    <thead>
                                        <tr>
                                            <th>Camera ID</th>
                                            <th>English Title</th>
                                            <th>Chinese Title</th>
                                            <th>Portuguese Title</th>
                                            <th>Japanese Title</th>
                                            <th>Embed URL</th>
                                            <th>Location</th>
                                        </tr>
                                    </thead>
                                    <tbody id="previewTableBody">
                                        <!-- Preview data will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="upload-actions">
                            <button class="btn btn-success" id="uploadBtn" disabled>
                                <i class="fas fa-upload"></i> Upload Cameras
                            </button>
                            <button class="btn btn-secondary" id="resetUploadBtn">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                        
                        <div class="upload-progress" id="uploadProgress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="uploadProgressFill"></div>
                            </div>
                            <div class="progress-text" id="uploadProgressText">0% Complete</div>
                            <div class="upload-status" id="uploadStatus">Ready to upload</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="camera-grid" id="cameraGrid">
                <!-- Camera cards will be dynamically inserted here -->
            </div>
        </div>
        
        <div class="modal" id="cameraModal">
            <div class="modal-content">
                <span class="close-modal" id="closeModal">×</span>
                <h2 id="modalTitle">Add New Camera</h2>
                
                <div class="form-group">
                    <label for="cameraId">Camera ID</label>
                    <input type="text" id="cameraId" placeholder="Unique identifier (e.g.,  camera-001)">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="englishTitle">English Title</label>
                        <input type="text" id="englishTitle" placeholder="Camera title in English">
                    </div>
                    <div class="form-group">
                        <label for="chineseTitle">Chinese Title</label>
                        <input type="text" id="chineseTitle" placeholder="Camera title in Chinese">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="portugueseTitle">Portuguese Title</label>
                        <input type="text" id="portugueseTitle" placeholder="Camera title in Portuguese">
                    </div>
                    <div class="form-group">
                        <label for="japaneseTitle">Japanese Title</label>
                        <input type="text" id="japaneseTitle" placeholder="Camera title in Japanese">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="embedUrl">Embed URL</label>
                    <input type="text" id="embedUrl" placeholder="Live stream URL (e.g.,  https: //...)">
                </div>
                
                <div class="form-group">
                    <label for="location">Location</label>
                    <select id="location" class="form-control">
                        <option value="macau-city">Macau City</option>
                        <option value="taipa">Taipa</option>
                        <option value="bridges">Cross-Sea Bridges</option>
                        <option value="border">Border Crossings</option>
                    </select>
                </div>
                
                <div style="display:  flex; gap:  15px; margin-top:  25px;">
                    <button class="btn" id="saveCameraBtn">
                        <i class="fas fa-save"></i> Save Camera
                    </button>
                    <button class="btn btn-secondary" id="cancelBtn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>
        </div>
        
        <div class="notification" id="notification">
            <p id="notificationMessage">Operation completed successfully!</p>
        </div>
        
        <footer>
            <p>Macau Traffic Monitor Staff Panel © 2026</p>
            <p>Data Source:  Firebase Realtime Database</p>
        </footer>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey:  "AIzaSyB1_sJvG1u47J3K0K0K0K0K0K0K0K0K0K0",   
            authDomain:  "macau-traffic-501cb.firebaseapp.com",   
            databaseURL:  "https: //macau-traffic-501cb-default-rtdb.firebaseio.com",   
            projectId:  "macau-traffic-501cb",   
            storageBucket:  "macau-traffic-501cb.appspot.com",   
            messagingSenderId:  "123456789012",   
            appId:  "1: 123456789012: web: abcdef1234567890abcdef"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // DOM Elements
        const authSection = document.getElementById('authSection');
        const camerasSection = document.getElementById('camerasSection');
        const cameraGrid = document.getElementById('cameraGrid');
        const cameraModal = document.getElementById('cameraModal');
        const notification = document.getElementById('notification');
        const statusIndicator = document.getElementById('statusIndicator');
        const statusText = document.getElementById('statusText');
        const cameraSelection = document.getElementById('cameraSelection');
        const bulkUpdateForm = document.getElementById('bulkUpdateForm');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const previewTableBody = document.getElementById('previewTableBody');
        const uploadBtn = document.getElementById('uploadBtn');
        const uploadProgress = document.getElementById('uploadProgress');
        const uploadProgressFill = document.getElementById('uploadProgressFill');
        const uploadProgressText = document.getElementById('uploadProgressText');
        const uploadStatus = document.getElementById('uploadStatus');

        // Stats elements
        const totalCamerasEl = document.getElementById('totalCameras');
        const selectedCamerasEl = document.getElementById('selectedCameras');
        const updatedCamerasEl = document.getElementById('updatedCameras');

        // Buttons
        const loginBtn = document.getElementById('loginBtn');
        const addCameraBtn = document.getElementById('addCameraBtn');
        const refreshBtn = document.getElementById('refreshBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const saveCameraBtn = document.getElementById('saveCameraBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const closeModal = document.getElementById('closeModal');
        const bulkUpdateBtn = document.getElementById('bulkUpdateBtn');
        const bulkUploadBtn = document.getElementById('bulkUploadBtn');
        const selectAllBtn = document.getElementById('selectAllBtn');
        const deselectAllBtn = document.getElementById('deselectAllBtn');
        const openBulkFormBtn = document.getElementById('openBulkFormBtn');
        const applyBulkUpdateBtn = document.getElementById('applyBulkUpdateBtn');
        const cancelBulkUpdateBtn = document.getElementById('cancelBulkUpdateBtn');
        const browseFileBtn = document.getElementById('browseFileBtn');
        const fileInput = document.getElementById('fileInput');
        const fileUploadArea = document.getElementById('fileUploadArea');
        const resetUploadBtn = document.getElementById('resetUploadBtn');
        const downloadTemplate = document.getElementById('downloadTemplate');
        const tabs = document.querySelectorAll('.tab');

        // Form fields
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const cameraIdInput = document.getElementById('cameraId');
        const englishTitleInput = document.getElementById('englishTitle');
        const chineseTitleInput = document.getElementById('chineseTitle');
        const portugueseTitleInput = document.getElementById('portugueseTitle');
        const japaneseTitleInput = document.getElementById('japaneseTitle');
        const embedUrlInput = document.getElementById('embedUrl');
        const locationSelect = document.getElementById('location');
        const bulkLocationSelect = document.getElementById('bulkLocation');
        const bulkEmbedUrlInput = document.getElementById('bulkEmbedUrl');

        // Current editing camera ID
        let currentEditingCameraId = null;

        // Authentication state
        let isAuthenticated = false;

        // Selected cameras for bulk update
        let selectedCameras = [];

        // All cameras data
        let allCameras = {};

        // CSV data for upload
        let csvData = [];

        // Initialize the application
        function init() {
            updateConnectionStatus(true);
            loadCameras();
        }

        // Update connection status indicator
        function updateConnectionStatus(connected) {
            if (connected) {
                statusIndicator.className = 'status-indicator status-connected';
                statusText.textContent = 'Connected to Firebase';
            } else {
                statusIndicator.className = 'status-indicator status-disconnected';
                statusText.textContent = 'Disconnected from Firebase';
            }
        }

        // Show notification
        function showNotification(message,  isError = false) {
            const notificationMessage = document.getElementById('notificationMessage');
            notificationMessage.textContent = message;
            
            if (isError) {
                notification.className = 'notification error';
            } else {
                notification.className = 'notification';
            }
            
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            },  3000);
        }

        // Login function
        function login() {
            const email = emailInput.value.trim();
            const password = passwordInput.value.trim();
            
            if (!email || !password) {
                showNotification('Please enter both email and password',  true);
                return;
            }
            
            // In a real app,  this would be a Firebase authentication call
            // For demo purposes,  we'll use a simple check
            if (email === 'admmin@macautraffic.com' && password === 'Admin123') {
                isAuthenticated = true;
                authSection.style.display = 'none';
                camerasSection.style.display = 'block';
                showNotification('Login successful!');
            } else {
                showNotification('Invalid credentials. Please try again.',  true);
            }
        }

        // Logout function
        function logout() {
            isAuthenticated = false;
            authSection.style.display = 'block';
            camerasSection.style.display = 'none';
            emailInput.value = '';
            passwordInput.value = '';
            showNotification('You have been logged out');
        }

        // Load cameras from Firebase
        function loadCameras() {
            cameraGrid.innerHTML = '<p style="text-align:  center; width:  100%;"><i class="fas fa-spinner fa-spin"></i> Loading cameras...</p>';
            
            const camerasRef = database.ref('cameras');
            camerasRef.once('value')
                .then((snapshot) => {
                    const cameras = snapshot.val();
                    if (cameras) {
                        allCameras = cameras;
                        displayCameras(cameras);
                        updateStats();
                    } else {
                        cameraGrid.innerHTML = '<p style="text-align:  center; width:  100%;">No cameras found</p>';
                        allCameras = {};
                        updateStats();
                    }
                })
                .catch((error) => {
                    console.error('Error loading cameras:  ',  error);
                    cameraGrid.innerHTML = '<p style="text-align:  center; width:  100%; color:  #ff4d4d;">Error loading cameras. Please try again.</p>';
                    showNotification('Failed to load cameras',  true);
                });
        }

        // Update statistics
        function updateStats() {
            totalCamerasEl.textContent = Object.keys(allCameras).length;
            selectedCamerasEl.textContent = selectedCameras.length;
            updatedCamerasEl.textContent = '0';
        }

        // Display cameras in the grid
        function displayCameras(cameras) {
            cameraGrid.innerHTML = '';
            
            Object.keys(cameras).forEach(cameraId => {
                const camera = cameras[cameraId];
                const cameraCard = document.createElement('div');
                cameraCard.className = 'camera-card';
                cameraCard.innerHTML = `
                    <div class="camera-title">
                        <i class="fas fa-video"></i> ${camera.titles.en}
                    </div>
                    <div class="camera-details">
                        <p><strong>ID:  </strong> ${cameraId}</p>
                        <p><strong>Location:  </strong> ${camera.location}</p>
                        <p><strong>URL:  </strong> ${camera.embedUrl}</p>
                    </div>
                    <iframe class="camera-iframe" src="${camera.embedUrl}" allowfullscreen></iframe>
                    <div class="camera-actions">
                        <button class="btn btn-secondary edit-btn" data-id="${cameraId}">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger delete-btn" data-id="${cameraId}">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                        <button class="btn btn-warning select-btn" data-id="${cameraId}">
                            <i class="fas fa-check-circle"></i> Select
                        </button>
                    </div>
                `;
                cameraGrid.appendChild(cameraCard);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click',  () => editCamera(btn.dataset.id));
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click',  () => deleteCamera(btn.dataset.id));
            });
            
            // Add event listeners to select buttons
            document.querySelectorAll('.select-btn').forEach(btn => {
                btn.addEventListener('click',  () => toggleCameraSelection(btn.dataset.id));
            });
        }

        // Toggle camera selection for bulk update
        function toggleCameraSelection(cameraId) {
            const index = selectedCameras.indexOf(cameraId);
            if (index === -1) {
                selectedCameras.push(cameraId);
            } else {
                selectedCameras.splice(index,  1);
            }
            updateCameraSelectionDisplay();
            updateStats();
        }

        // Update camera selection display
        function updateCameraSelectionDisplay() {
            if (selectedCameras.length === 0) {
                cameraSelection.innerHTML = '<p>No cameras selected</p>';
                openBulkFormBtn.disabled = true;
                return;
            }
            
            openBulkFormBtn.disabled = false;
            cameraSelection.innerHTML = '';
            
            selectedCameras.forEach(cameraId => {
                const camera = allCameras[cameraId];
                if (camera) {
                    const item = document.createElement('div');
                    item.className = 'camera-selection-item';
                    item.innerHTML = `
                        <span>${camera.titles.en}</span>
                        <button class="remove-btn" data-id="${cameraId}">×</button>
                    `;
                    cameraSelection.appendChild(item);
                }
            });
            
            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.addEventListener('click',  () => {
                    const cameraId = btn.dataset.id;
                    const index = selectedCameras.indexOf(cameraId);
                    if (index !== -1) {
                        selectedCameras.splice(index,  1);
                        updateCameraSelectionDisplay();
                        updateStats();
                    }
                });
            });
        }

        // Select all cameras
        function selectAllCameras() {
            selectedCameras = Object.keys(allCameras);
            updateCameraSelectionDisplay();
            updateStats();
        }

        // Deselect all cameras
        function deselectAllCameras() {
            selectedCameras = [];
            updateCameraSelectionDisplay();
            updateStats();
        }

        // Open bulk update form
        function openBulkUpdateForm() {
            if (selectedCameras.length === 0) {
                showNotification('Please select at least one camera',  true);
                return;
            }
            bulkUpdateForm.classList.add('active');
        }

        // Apply bulk update
        async function applyBulkUpdate() {
            const location = bulkLocationSelect.value;
            const embedUrl = bulkEmbedUrlInput.value.trim();
            
            if (!location && !embedUrl) {
                showNotification('Please specify at least one property to update',  true);
                return;
            }
            
            // Show progress
            progressContainer.style.display = 'block';
            progressFill.style.width = '0%';
            progressText.textContent = '0% Complete';
            
            // Disable buttons during update
            applyBulkUpdateBtn.disabled = true;
            cancelBulkUpdateBtn.disabled = true;
            
            try {
                const total = selectedCameras.length;
                let completed = 0;
                updatedCamerasEl.textContent = '0';
                
                // Update each selected camera
                for (const cameraId of selectedCameras) {
                    const cameraRef = database.ref('cameras/' + cameraId);
                    const snapshot = await cameraRef.once('value');
                    const cameraData = snapshot.val();
                    
                    if (cameraData) {
                        // Update only the specified properties
                        if (location) {
                            cameraData.location = location;
                        }
                        if (embedUrl) {
                            cameraData.embedUrl = embedUrl;
                        }
                        
                        // Save updated data
                        await cameraRef.set(cameraData);
                    }
                    
                    // Update progress
                    completed++;
                    const progress = Math.round((completed / total) * 100);
                    progressFill.style.width = progress + '%';
                    progressText.textContent = `${progress}% Complete`;
                    updatedCamerasEl.textContent = completed;
                }
                
                // Reset form and selection
                bulkLocationSelect.value = '';
                bulkEmbedUrlInput.value = '';
                selectedCameras = [];
                updateCameraSelectionDisplay();
                bulkUpdateForm.classList.remove('active');
                updateStats();
                
                // Reload cameras
                loadCameras();
                
                showNotification(`Successfully updated ${total} cameras!`);
            } catch (error) {
                console.error('Error during bulk update:  ',  error);
                showNotification('Failed to update cameras',  true);
            } finally {
                // Re-enable buttons
                applyBulkUpdateBtn.disabled = false;
                cancelBulkUpdateBtn.disabled = false;
                
                // Hide progress after delay
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                },  2000);
            }
        }

        // Open modal for adding new camera
        function openAddCameraModal() {
            currentEditingCameraId = null;
            document.getElementById('modalTitle').textContent = 'Add New Camera';
            cameraIdInput.value = '';
            englishTitleInput.value = '';
            chineseTitleInput.value = '';
            portugueseTitleInput.value = '';
            japaneseTitleInput.value = '';
            embedUrlInput.value = '';
            locationSelect.value = 'macau-city';
            cameraModal.style.display = 'flex';
        }

        // Edit existing camera
        function editCamera(cameraId) {
            currentEditingCameraId = cameraId;
            document.getElementById('modalTitle').textContent = 'Edit Camera';
            
            const camerasRef = database.ref('cameras/' + cameraId);
            camerasRef.once('value')
                .then((snapshot) => {
                    const camera = snapshot.val();
                    if (camera) {
                        cameraIdInput.value = cameraId;
                        cameraIdInput.disabled = true;
                        englishTitleInput.value = camera.titles.en;
                        chineseTitleInput.value = camera.titles.zh;
                        portugueseTitleInput.value = camera.titles.pt;
                        japaneseTitleInput.value = camera.titles.ja;
                        embedUrlInput.value = camera.embedUrl;
                        locationSelect.value = camera.location;
                        cameraModal.style.display = 'flex';
                    } else {
                        showNotification('Camera not found',  true);
                    }
                })
                .catch((error) => {
                    console.error('Error loading camera:  ',  error);
                    showNotification('Failed to load camera data',  true);
                });
        }

        // Save camera (add or update)
        function saveCamera() {
            const cameraId = cameraIdInput.value.trim();
            const englishTitle = englishTitleInput.value.trim();
            const chineseTitle = chineseTitleInput.value.trim();
            const portugueseTitle = portugueseTitleInput.value.trim();
            const japaneseTitle = japaneseTitleInput.value.trim();
            const embedUrl = embedUrlInput.value.trim();
            const location = locationSelect.value;
            
            if (!cameraId || !englishTitle || !embedUrl) {
                showNotification('Please fill in all required fields',  true);
                return;
            }
            
            const cameraData = {
                titles:  {
                    en:  englishTitle,  
                    zh:  chineseTitle,  
                    pt:  portugueseTitle,  
                    ja:  japaneseTitle
                },  
                embedUrl:  embedUrl,  
                location:  location
            };
            
            const camerasRef = database.ref('cameras/' + cameraId);
            camerasRef.set(cameraData)
                .then(() => {
                    showNotification(`Camera ${currentEditingCameraId ? 'updated' :  'added'} successfully!`);
                    cameraModal.style.display = 'none';
                    loadCameras();
                })
                .catch((error) => {
                    console.error('Error saving camera:  ',  error);
                    showNotification('Failed to save camera',  true);
                });
        }

        // Delete camera
        function deleteCamera(cameraId) {
            if (confirm('Are you sure you want to delete this camera? This action cannot be undone.')) {
                const camerasRef = database.ref('cameras/' + cameraId);
                camerasRef.remove()
                    .then(() => {
                        showNotification('Camera deleted successfully!');
                        loadCameras();
                    })
                    .catch((error) => {
                        console.error('Error deleting camera:  ',  error);
                        showNotification('Failed to delete camera',  true);
                    });
            }
        }

        // Close modal
        function closeCameraModal() {
            cameraModal.style.display = 'none';
            cameraIdInput.disabled = false;
        }

        // Cancel bulk update
        function cancelBulkUpdate() {
            bulkUpdateForm.classList.remove('active');
            bulkLocationSelect.value = '';
            bulkEmbedUrlInput.value = '';
        }

        // Handle file upload
        function handleFileUpload(file) {
            if (!file) return;
            
            // Update file info
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            fileInfo.classList.add('active');
            
            // Parse CSV file
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                parseCSV(content);
            };
            reader.readAsText(file);
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes',  'KB',  'MB',  'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k,  i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Parse CSV content
        function parseCSV(content) {
            const lines = content.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            
            // Clear previous data
            csvData = [];
            previewTableBody.innerHTML = '';
            
            // Process each line
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const values = line.split(',').map(v => v.trim().replace(/"/g, ''));
                if (values.length < 7) continue;
                
                const cameraData = {
                    id: values[0],
                    en: values[1],
                    zh: values[2],
                    pt: values[3],
                    ja: values[4],
                    embedUrl: values[5],
                    location: values[6]
                };
                
                csvData.push(cameraData);
                
                // Add to preview table
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${cameraData.id}</td>
                    <td>${cameraData.en}</td>
                    <td>${cameraData.zh}</td>
                    <td>${cameraData.pt}</td>
                    <td>${cameraData.ja}</td>
                    <td>${cameraData.embedUrl}</td>
                    <td>${cameraData.location}</td>
                `;
                previewTableBody.appendChild(row);
            }
            
            // Enable upload button if we have data
            uploadBtn.disabled = csvData.length === 0;
        }

        // Upload cameras from CSV
        async function uploadCameras() {
            if (csvData.length === 0) {
                showNotification('No camera data to upload',  true);
                return;
            }
            
            // Show upload progress
            uploadProgress.classList.add('active');
            uploadProgressFill.style.width = '0%';
            uploadProgressText.textContent = '0% Complete';
            uploadStatus.textContent = 'Processing upload...';
            uploadStatus.className = 'upload-status processing';
            
            // Disable buttons during upload
            uploadBtn.disabled = true;
            resetUploadBtn.disabled = true;
            
            try {
                const total = csvData.length;
                let completed = 0;
                
                // Upload each camera
                for (const camera of csvData) {
                    const cameraData = {
                        titles:  {
                            en:  camera.en,
                            zh:  camera.zh,
                            pt:  camera.pt,
                            ja:  camera.ja
                        },
                        embedUrl:  camera.embedUrl,
                        location:  camera.location
                    };
                    
                    // Save to Firebase
                    await database.ref('cameras/' + camera.id).set(cameraData);
                    
                    // Update progress
                    completed++;
                    const progress = Math.round((completed / total) * 100);
                    uploadProgressFill.style.width = progress + '%';
                    uploadProgressText.textContent = `${progress}% Complete`;
                }
                
                // Update status
                uploadStatus.textContent = 'Upload completed successfully!';
                uploadStatus.className = 'upload-status completed';
                
                // Reset form
                resetUploadForm();
                
                // Reload cameras
                loadCameras();
                
                showNotification(`Successfully uploaded ${total} cameras!`);
            } catch (error) {
                console.error('Error during upload:  ',  error);
                uploadStatus.textContent = 'Upload failed. Please try again.';
                uploadStatus.className = 'upload-status error';
                showNotification('Failed to upload cameras',  true);
            } finally {
                // Re-enable buttons
                uploadBtn.disabled = false;
                resetUploadBtn.disabled = false;
                
                // Hide progress after delay
                setTimeout(() => {
                    uploadProgress.classList.remove('active');
                },  3000);
            }
        }

        // Reset upload form
        function resetUploadForm() {
            fileInput.value = '';
            fileInfo.classList.remove('active');
            previewTableBody.innerHTML = '';
            csvData = [];
            uploadBtn.disabled = true;
        }

        // Download CSV template
        function downloadCSVTemplate() {
            const csvContent = "Camera ID,English Title,Chinese Title,Portuguese Title,Japanese Title,Embed URL,Location\n" +
                              "camera-001,Camera 1,,,https: //example.com/camera1,macau-city\n" +
                              "camera-002,Camera 2,,,https: //example.com/camera2,taipa\n" +
                              "camera-003,Camera 3,,,https: //example.com/camera3,border";
            
            const blob = new Blob([csvContent],  { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href',  url);
            link.setAttribute('download',  'camera_template.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Switch tabs
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Add active class to clicked tab
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        // Event Listeners
        loginBtn.addEventListener('click',  login);
        addCameraBtn.addEventListener('click',  openAddCameraModal);
        refreshBtn.addEventListener('click',  loadCameras);
        logoutBtn.addEventListener('click',  logout);
        saveCameraBtn.addEventListener('click',  saveCamera);
        cancelBtn.addEventListener('click',  closeCameraModal);
        closeModal.addEventListener('click',  closeCameraModal);
        bulkUpdateBtn.addEventListener('click',  () => switchTab('bulk-update'));
        bulkUploadBtn.addEventListener('click',  () => switchTab('bulk-upload'));
        selectAllBtn.addEventListener('click',  selectAllCameras);
        deselectAllBtn.addEventListener('click',  deselectAllCameras);
        openBulkFormBtn.addEventListener('click',  openBulkUpdateForm);
        applyBulkUpdateBtn.addEventListener('click',  applyBulkUpdate);
        cancelBulkUpdateBtn.addEventListener('click',  cancelBulkUpdate);
        
        // File upload events
        browseFileBtn.addEventListener('click',  () => fileInput.click());
        fileInput.addEventListener('change',  (e) => {
            if (e.target.files.length > 0) {
                handleFileUpload(e.target.files[0]);
            }
        });
        
        fileUploadArea.addEventListener('dragover',  (e) => {
            e.preventDefault();
            fileUploadArea.style.backgroundColor = 'rgba(255,  215,  0,  0.2)';
        });
        
        fileUploadArea.addEventListener('dragleave',  () => {
            fileUploadArea.style.backgroundColor = '';
        });
        
        fileUploadArea.addEventListener('drop',  (e) => {
            e.preventDefault();
            fileUploadArea.style.backgroundColor = '';
            if (e.dataTransfer.files.length > 0) {
                handleFileUpload(e.dataTransfer.files[0]);
            }
        });
        
        uploadBtn.addEventListener('click',  uploadCameras);
        resetUploadBtn.addEventListener('click',  resetUploadForm);
        downloadTemplate.addEventListener('click',  (e) => {
            e.preventDefault();
            downloadCSVTemplate();
        });
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click',  () => {
                switchTab(tab.dataset.tab);
            });
        });
        
        // Close modal when clicking outside
        window.addEventListener('click',  (e) => {
            if (e.target === cameraModal) {
                closeCameraModal();
            }
        });

        // Initialize the app
        init();
    </script>
</body>
</html>
